<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ÂÖ¨Âè∏Ê±âËØ≠ ‚Äì Unit 1 ÂÖ¨Âè∏Êú∫ÊûÑ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:'Segoe UI',system-ui,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);margin:0;min-height:100vh;padding:20px 10px}
.container{max-width:900px;margin:0 auto;background:rgba(255,255,255,0.95);border-radius:32px;padding:40px;box-shadow:0 40px 80px rgba(0,0,0,.15),0 0 0 1px rgba(255,255,255,.3);backdrop-filter:blur(10px)}
h1{text-align:center;margin-top:0;color:#1f2937;font-size:28px;font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,.05)}
button{padding:14px 28px;border-radius:16px;border:none;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;cursor:pointer;margin:6px;font-size:16px;font-weight:600;transition:all .3s ease;box-shadow:0 4px 12px rgba(102,126,234,.3)}
button:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(102,126,234,.4)}
button:active{transform:translateY(0)}
input{width:100%;font-size:22px;padding:18px;border-radius:20px;border:3px solid #e0e7ff;outline:none;box-sizing:border-box;transition:all .3s ease;background:#fafbff;font-family:'Microsoft YaHei','SimHei',sans-serif;word-break:break-all;line-height:1.6}
input:focus{border-color:#667eea;background:white;box-shadow:0 0 0 4px rgba(102,126,234,.1)}
.answerWord{color:#0ea5e9;font-weight:700;border-bottom:3px solid #0ea5e9;padding:2px 4px;border-radius:4px;background:rgba(14,165,233,.1)}
.hidden{display:none}
.center{text-align:center;margin:20px 0}
.word{display:inline-block;min-width:58px;text-align:center;font-weight:500}
.pin{display:inline-block;min-width:58px;text-align:center;color:#6b7280;font-size:15px}
#qtitle{color:#667eea;font-weight:600;font-size:18px}
#instruction{color:#6b7280;margin:10px 0 20px;font-size:16px}
#sentence{font-size:26px;margin:20px 0;line-height:1.8;font-weight:500;color:#1f2937}
#pinyin{margin-top:15px;font-size:18px;line-height:1.8}
#meaning{margin-top:15px;font-size:19px;color:#059669;font-weight:500;background:rgba(5,150,105,.05);padding:12px 16px;border-radius:12px;border-left:4px solid #059669}
.confetti{position:fixed;width:10px;height:10px;border-radius:50%;pointer-events:none;z-index:9999}
@keyframes confetti-fall{to{transform:translateY(100vh) rotate(720deg);opacity:0}}
.historyItem{background:white;border-radius:12px;padding:16px;margin-bottom:12px;border-left:4px solid #e5e7eb;transition:all .2s}
.historyItem:hover{transform:translateX(4px);box-shadow:0 4px 12px rgba(0,0,0,.1)}
.historyItem.correct{border-left-color:#16a34a;background:rgba(16,185,129,.05)}
.historyItem.wrong{border-left-color:#dc2626;background:rgba(239,68,68,.05)}
.historyItem.skipped{border-left-color:#f59e0b;background:rgba(245,158,11,.05)}
.historyMeta{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;font-size:14px;color:#6b7280}
.historyQuestion{font-size:18px;color:#1f2937;margin:8px 0}
.historyAnswer{font-size:16px;margin-top:8px;padding:8px;border-radius:6px;background:rgba(0,0,0,.02)}
.userAnswer{color:#0ea5e9;font-weight:600}
.correctAnswer{color:#16a34a;font-weight:600}
.statusBadge{padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600}
.statusBadge.correct{background:#dcfce7;color:#16a34a}
.statusBadge.wrong{background:#fee2e2;color:#dc2626}
.statusBadge.skipped{background:#fef3c7;color:#d97706}
</style>
</head>

<body>

<div class="container">

<h1>ÂÖ¨Âè∏Ê±âËØ≠ ‚Äì Unit 1 ÂÖ¨Âè∏Êú∫ÊûÑ</h1>

<div class="center">
<button onclick="start()">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
<button onclick="next()" id="nextBtn" class="hidden">‚è≠ Ti·∫øp t·ª•c</button>
<button onclick="toggleHistory()" id="historyBtn" class="hidden">üìã Xem l·∫°i</button>
</div>

<div id="main" class="hidden">

<h3 id="qtitle"></h3>
<div id="instruction" style="color:#555"></div>

<div id="pinyin" style="margin-top:10px;font-size:17px"></div>

<div id="sentence" style="font-size:22px;margin-top:10px"></div>

<input id="answer" placeholder="Nh·∫≠p ti·∫øng Trung‚Ä¶" oninput="autoCheck()">

<div style="margin-top:12px">
<button onclick="playAudio()">üîä Nghe l·∫°i</button>
<button onclick="showVietnamese()">üí° Nghƒ©a</button>
<button onclick="showAnswer()">üëÄ ƒê√°p √°n</button>
</div>

<div id="meaning" style="margin-top:8px;font-size:18px"></div>

</div>

<div id="historyView" class="hidden">
<h3 style="color:#667eea;margin-bottom:20px">üìã L·ªãch s·ª≠ l√†m b√†i</h3>
<div id="historyList"></div>
<div class="center" style="margin-top:20px">
<button onclick="toggleHistory()">‚óÄ Quay l·∫°i</button>
<button onclick="clearHistory()" style="background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%)">üóë X√≥a l·ªãch s·ª≠</button>
</div>
</div>

</div>

<script>

/************* UNIT 1 ‚Äì 48 C√ÇU *************/

let questions = [

/********** ËØæÊñá A **********/
{type:"listen",cnWords:["ÂàòÊ≥¢","ÈÄöËøá‰∫Ü","ËøúÂ§ßÂÖ¨Âè∏","ÁöÑ","Èù¢ËØïÔºå"],pyWords:["Li√∫ B≈ç","t≈çnggu√≤ le","Yu«énd√† g≈çngsƒ´","de","mi√†nsh√¨,"],vi:"L∆∞u Ba v∆∞·ª£t qua ph·ªèng v·∫•n,"},
{type:"listen",cnWords:["Êàê‰∏∫","ËøôÂÆ∂ÂÖ¨Âè∏ÁöÑ","ÈîÄÂîÆÈÉ®ÁªèÁêÜ„ÄÇ"],pyWords:["ch√©ngw√©i","zh√® jiƒÅ g≈çngsƒ´ de","xiƒÅosh√≤u b√π jƒ´ngl«ê."],vi:"v√† tr·ªü th√†nh tr∆∞·ªüng ph√≤ng kinh doanh."},

{type:"listen",cnWords:["Âú®","Ê≠£Âºè","‰∏äÁè≠","‰πãÂâçÔºå"],pyWords:["Z√†i","zh√®ngsh√¨","sh√†ngbƒÅn","zhƒ´qi√°n,"],vi:"Tr∆∞·ªõc khi ƒëi l√†m ch√≠nh th·ª©c,"},
{type:"listen",cnWords:["ÂÖ¨Âè∏","ÂÆâÊéí‰ªñ","ÂÖà","‰∫ÜËß£","ÂÖ¨Âè∏Êú∫ÊûÑ„ÄÇ"],pyWords:["g≈çngsƒ´","ƒÅnp√°i tƒÅ","xiƒÅn","li«éojiƒõ","g≈çngsƒ´ jƒ´g√≤u."],vi:"c√¥ng ty s·∫Øp x·∫øp anh t√¨m hi·ªÉu c∆° c·∫•u t·ªï ch·ª©c„ÄÇ"},

{type:"listen",cnWords:["Áßò‰π¶","ÁéãËãπ","Ë¥üË¥£","Êé•ÂæÖ‰ªñ„ÄÇ"],pyWords:["M√¨sh≈´","W√°ng P√≠ng","f√πz√©","jiƒìd√†i tƒÅ."],vi:"Th∆∞ k√Ω V∆∞∆°ng B√¨nh ph·ª• tr√°ch ti·∫øp ƒë√≥n anh„ÄÇ"},

{type:"listen",cnWords:["Êàë","ÂßìÁéãÔºå"],pyWords:["W«í","x√¨ng W√°ng,"],vi:"T√¥i h·ªç V∆∞∆°ng,"},
{type:"listen",cnWords:["Âè´","ÁéãËãπÔºå"],pyWords:["ji√†o","W√°ng P√≠ng,"],vi:"t√™n l√† V∆∞∆°ng B√¨nh,"},
{type:"listen",cnWords:["ÊòØ","ÈôàÊÄª","ÁöÑ","Áßò‰π¶„ÄÇ"],pyWords:["sh√¨","Ch√©n z«íng","de","m√¨sh≈´."],vi:"l√† th∆∞ k√Ω c·ªßa T·ªïng gi√°m ƒë·ªëc Tr·∫ßn„ÄÇ"},

{type:"listen",cnWords:["Ê¨¢Ëøé","ÊÇ®","Âä†ÂÖ•","ËøúÂ§ßÂÖ¨Âè∏„ÄÇ"],pyWords:["HuƒÅny√≠ng","n√≠n","jiƒÅr√π","Yu«énd√† g≈çngsƒ´."],vi:"Ch√†o m·ª´ng anh gia nh·∫≠p c√¥ng ty„ÄÇ"},

{type:"listen",cnWords:["‰ª•Âêé","Êàë‰ª¨","Ë¶Å","ÁªèÂ∏∏","‰∏ÄËµ∑","Â∑•‰Ωú„ÄÇ"],pyWords:["Y«êh√≤u","w«ímen","y√†o","jƒ´ngch√°ng","yƒ´q«ê","g≈çngzu√≤."],vi:"Sau n√†y ch√∫ng ta s·∫Ω th∆∞·ªùng xuy√™n l√†m vi·ªác c√πng nhau„ÄÇ"},

{type:"listen",cnWords:["ÈÇ£","Êàë","ÂÖà","ÁªôÊÇ®","‰ªãÁªç","‰∏Ä‰∏ã","ÂÖ¨Âè∏Êú∫ÊûÑ„ÄÇ"],pyWords:["N√†","w«í","xiƒÅn","gƒõi n√≠n","ji√®sh√†o","yƒ´xi√†","g≈çngsƒ´ jƒ´g√≤u."],vi:"V·∫≠y ƒë·ªÉ t√¥i gi·ªõi thi·ªáu s∆° qua c∆° c·∫•u c√¥ng ty„ÄÇ"},

{type:"listen",cnWords:["Êàë‰ª¨ÂÖ¨Âè∏","ÁöÑ","Ëë£‰∫ãÈïø","ÊòØ","Â∏ÉËé±ÂÖã","ÂÖàÁîü„ÄÇ"],pyWords:["W«ímen g≈çngsƒ´","de","d«íngsh√¨zh«éng","sh√¨","B√πl√°ik√®","xiƒÅnsheng."],vi:"Ch·ªß t·ªãch c√¥ng ty l√† √¥ng Blake„ÄÇ"},

{type:"listen",cnWords:["ÂÖ¨Âè∏","‰∫é","1981Âπ¥","Âú®","ÁæéÂõΩ","ÂàõÁ´ã„ÄÇ"],pyWords:["G≈çngsƒ´","y√∫","yƒ´ ji«î bƒÅ yƒ´ ni√°n","z√†i","Mƒõigu√≥","chu√†ngl√¨."],vi:"C√¥ng ty ƒë∆∞·ª£c th√†nh l·∫≠p t·∫°i M·ªπ v√†o nƒÉm 1981„ÄÇ"},

{type:"listen",cnWords:["Êàë‰ª¨ÂÖ¨Âè∏","Âú®","‰∏ñÁïå","ÂçÅÂá†‰∏™","ÂõΩÂÆ∂","ÈÉΩÊúâ","ÂàÜÂÖ¨Âè∏„ÄÇ"],pyWords:["W«ímen g≈çngsƒ´","z√†i","sh√¨ji√®","sh√≠ j«ê g√®","gu√≥jiƒÅ","d≈çu y«íu","fƒìng≈çngsƒ´."],vi:"C√¥ng ty c√≥ chi nh√°nh t·∫°i h∆°n m∆∞·ªùi qu·ªëc gia tr√™n th·∫ø gi·ªõi„ÄÇ"},

{type:"listen",cnWords:["‰∏≠ÂõΩ","ÂàÜÂÖ¨Âè∏ÁöÑ","Â∑•‰ΩúÔºå"],pyWords:["Zh≈çnggu√≥","fƒìng≈çngsƒ´ de","g≈çngzu√≤,"],vi:"C√¥ng vi·ªác c·ªßa chi nh√°nh Trung Qu·ªëc,"},
{type:"listen",cnWords:["‰∏ªË¶Å","ÊòØ","ÈôàÊÄª","Ë¥üË¥£„ÄÇ"],pyWords:["zh«îy√†o","sh√¨","Ch√©n z«íng","f√πz√©."],vi:"ch·ªß y·∫øu do T·ªïng gi√°m ƒë·ªëc Tr·∫ßn ph·ª• tr√°ch„ÄÇ"},

{type:"listen",cnWords:["‰ªñ","‰πüÊòØ","‰∫öÂ§™Âå∫","ÁöÑ","ÂâØÊÄªË£Å„ÄÇ"],pyWords:["TƒÅ","yƒõ sh√¨","Y√†t√†iq≈´","de","f√π z«íngc√°i."],vi:"√îng c≈©ng l√† ph√≥ t·ªïng ph·ª• tr√°ch khu v·ª±c ch√¢u √Å‚ÄîTBD„ÄÇ"},

{type:"listen",cnWords:["Ë°åÊîø","ÂâØÊÄª","Âè´","Âê¥ÊñáÈùíÔºå"],pyWords:["X√≠ngzh√®ng","f√πz«íng","ji√†o","W√∫ W√©nqƒ´ng,"],vi:"Ph√≥ t·ªïng h√†nh ch√≠nh t√™n l√† Ng√¥ VƒÉn Thanh,"},
{type:"listen",cnWords:["Â•π","ÊòØ‰∏Ä‰Ωç","Â•≥Â£´„ÄÇ"],pyWords:["tƒÅ","sh√¨ yƒ´ w√®i","n«ösh√¨."],vi:"b√† ·∫•y l√† n·ªØ„ÄÇ"},

{type:"listen",cnWords:["Áîü‰∫ß","ÂâØÊÄª","ÊòØ","Âë®ÂÅ•„ÄÇ"],pyWords:["Shƒìngch«én","f√πz«íng","sh√¨","Zh≈çu Ji√†n."],vi:"Ph√≥ t·ªïng s·∫£n xu·∫•t l√† Chu Ki·ªán„ÄÇ"},

{type:"listen",cnWords:["ÊäÄÊúØ","ÊÄªÁõë","ÊòØ","Ê†ºÊûó","ÂÖàÁîü„ÄÇ"],pyWords:["J√¨sh√π","z«íngjiƒÅn","sh√¨","G√©l√≠n","xiƒÅnsheng."],vi:"Gi√°m ƒë·ªëc k·ªπ thu·∫≠t l√† √¥ng Green„ÄÇ"},

{type:"listen",cnWords:["ÂæàÂ§ö‰∫∫","ËßâÂæó","Ë∑ü‰ªñ","‰∏ÄËµ∑","Â∑•‰ΩúÔºå"],pyWords:["Hƒõn du≈ç r√©n","ju√©de","gƒìn tƒÅ","yƒ´q«ê","g≈çngzu√≤,"],vi:"Nhi·ªÅu ng∆∞·ªùi c·∫£m th·∫•y l√†m vi·ªác v·ªõi √¥ng ·∫•y,"},
{type:"listen",cnWords:["ÈùûÂ∏∏","ÊÑâÂø´„ÄÇ"],pyWords:["fƒìich√°ng","y√∫ku√†i."],vi:"r·∫•t vui v·∫ª„ÄÇ"},

/********** ËØæÊñá B **********/

{type:"listen",cnWords:["Ê¨¢Ëøé","Â§ßÂÆ∂","Êù•","Êàë‰ª¨ÂÖ¨Âè∏","ÂèÇËßÇ„ÄÇ"],pyWords:["HuƒÅny√≠ng","d√†jiƒÅ","l√°i","w«ímen g≈çngsƒ´","cƒÅnguƒÅn."],vi:"Ch√†o m·ª´ng m·ªçi ng∆∞·ªùi ƒë·∫øn tham quan c√¥ng ty ch√∫ng t√¥i„ÄÇ"},

{type:"listen",cnWords:["ËøôÊòØ","Êàë‰ª¨ÂÖ¨Âè∏","ÁöÑ","ÁªÑÁªáÊú∫ÊûÑÂõæ„ÄÇ"],pyWords:["Zh√® sh√¨","w«ímen g≈çngsƒ´","de","z«îzhƒ´ jƒ´g√≤u t√∫."],vi:"ƒê√¢y l√† s∆° ƒë·ªì c∆° c·∫•u t·ªï ch·ª©c c√¥ng ty„ÄÇ"},

{type:"listen",cnWords:["Êàë‰ª¨ÂÖ¨Âè∏","ÊÄªÈÉ®","ËÆæÂú®","ÁæéÂõΩÁ∫ΩÁ∫¶„ÄÇ"],pyWords:["W«ímen g≈çngsƒ´","z«íngb√π","sh√® z√†i","Mƒõigu√≥ Ni«îyuƒì."],vi:"T·ªïng b·ªô c√¥ng ty ƒë·∫∑t t·∫°i New York, M·ªπ„ÄÇ"},

{type:"listen",cnWords:["ÂÖ¨Âè∏","ÊàêÁ´ã‰∫é","1981Âπ¥„ÄÇ"],pyWords:["G≈çngsƒ´","ch√©ngl√¨ y√∫","yƒ´ ji«î bƒÅ yƒ´ ni√°n."],vi:"C√¥ng ty th√†nh l·∫≠p nƒÉm 1981„ÄÇ"},

{type:"listen",cnWords:["‰∏≠ÂõΩ","ÂàÜÂÖ¨Âè∏","ÊàêÁ´ã‰∫é","1993Âπ¥„ÄÇ"],pyWords:["Zh≈çnggu√≥","fƒìng≈çngsƒ´","ch√©ngl√¨ y√∫","yƒ´ ji«î ji«î sƒÅn ni√°n."],vi:"Chi nh√°nh Trung Qu·ªëc th√†nh l·∫≠p nƒÉm 1993„ÄÇ"},

{type:"listen",cnWords:["Êàë‰ª¨ÂÖ¨Âè∏","ÊúÄÈ´òÈ¢ÜÂØº","ÊòØ","ÊÄªÁªèÁêÜ„ÄÇ"],pyWords:["W«ímen g≈çngsƒ´","zu√¨gƒÅo l«êngd«éo","sh√¨","z«íngjƒ´ngl«ê."],vi:"Ng∆∞·ªùi l√£nh ƒë·∫°o cao nh·∫•t c·ªßa c√¥ng ty l√† t·ªïng gi√°m ƒë·ªëc„ÄÇ"},

{type:"listen",cnWords:["Áîü‰∫ß","ÂâØÊÄª","Ë¥üË¥£","Áîü‰∫ßÈÉ®Ôºå"],pyWords:["Shƒìngch«én","f√πz«íng","f√πz√©","shƒìngch«én b√π,"],vi:"Ph√≥ t·ªïng s·∫£n xu·∫•t ph·ª• tr√°ch ph√≤ng s·∫£n xu·∫•t,"},
{type:"listen",cnWords:["‰∫ßÂìÅÈÉ®","Âíå","ÈááË¥≠ÈÉ®„ÄÇ"],pyWords:["ch«énp«ên b√π","h√©","c«éig√≤u b√π."],vi:"ph√≤ng s·∫£n ph·∫©m v√† ph√≤ng thu mua„ÄÇ"},

{type:"listen",cnWords:["Ë°åÊîø","ÂâØÊÄª","Ë¥üË¥£","Ë°åÊîøÈÉ®Ôºå"],pyWords:["X√≠ngzh√®ng","f√πz«íng","f√πz√©","x√≠ngzh√®ng b√π,"],vi:"Ph√≥ t·ªïng h√†nh ch√≠nh ph·ª• tr√°ch ph√≤ng h√†nh ch√≠nh,"},
{type:"listen",cnWords:["‰∫∫‰∫ãÈÉ®","Âíå","Ë¥¢Âä°ÈÉ®„ÄÇ"],pyWords:["r√©nsh√¨ b√π","h√©","c√°iw√π b√π."],vi:"ph√≤ng nh√¢n s·ª± v√† ph√≤ng t√†i v·ª•„ÄÇ"},

{type:"listen",cnWords:["ÂïÜÂä°ÂèëÂ±ïÈÉ®","Ë¥üË¥£","Â∏ÇÂú∫Ê∏†ÈÅì","ÁöÑ","ÂºÄÊãì„ÄÇ"],pyWords:["ShƒÅngw√π fƒÅzh«én b√π","f√πz√©","sh√¨ch«éng q√∫d√†o","de","kƒÅitu√≤."],vi:"Ph√≤ng ph√°t tri·ªÉn th∆∞∆°ng m·∫°i ph·ª• tr√°ch khai th√°c k√™nh th·ªã tr∆∞·ªùng„ÄÇ"},

{type:"listen",cnWords:["ÊâÄÊúâ","ÈÉ®Èó®","Áõ∏‰∫í","ÈÖçÂêàÔºå"],pyWords:["Su«íy«íu","b√πm√©n","xiƒÅngh√π","p√®ih√©,"],vi:"T·∫•t c·∫£ c√°c ph√≤ng ban ph·ªëi h·ª£p v·ªõi nhau,"},
{type:"listen",cnWords:["ÂÖ±Âêå","Âä™Âäõ„ÄÇ"],pyWords:["g√≤ngt√≥ng","n«îl√¨."],vi:"c√πng nhau c·ªë g·∫Øng„ÄÇ"},

/********** Â°´Á©∫ 12 **********/

{type:"fill",
 cnWords:["‰∏≠ÂõΩ","‰∫é","2001Âπ¥","Â∫ï","Ê≠£Âºè","Âä†ÂÖ•","‰∫Ü","WTO„ÄÇ"],
 pyWords:["Zh≈çnggu√≥","y√∫","√®r l√≠ng l√≠ng yƒ´ ni√°n","d«ê","zh√®ngsh√¨","jiƒÅr√π","le","WTO."],
 missing:"Âä†ÂÖ•",
 vi:"Trung Qu·ªëc gia nh·∫≠p WTO v√†o cu·ªëi nƒÉm 2001„ÄÇ"},

{type:"fill",
 cnWords:["‰ªñ","Âêë","Êàë","ËØ∑Êïô","‰∏Ä‰∏™","ÈóÆÈ¢ò„ÄÇ"],
 pyWords:["TƒÅ","xi√†ng","w«í","q«êngji√†o","y√≠ g√®","w√®nt√≠."],
 missing:"ËØ∑Êïô",
 vi:"Anh ·∫•y th·ªânh gi√°o t√¥i m·ªôt c√¢u h·ªèi„ÄÇ"},

{type:"fill",
 cnWords:["ËøôÂÆ∂","ÂÖ¨Âè∏","ÊúÄÂàù","ÊàêÁ´ã","‰∫é","‰∏äÊµ∑„ÄÇ"],
 pyWords:["Zh√® jiƒÅ","g≈çngsƒ´","zu√¨ch≈´","ch√©ngl√¨","y√∫","Sh√†ngh«éi."],
 missing:"ÊàêÁ´ã",
 vi:"C√¥ng ty ban ƒë·∫ßu th√†nh l·∫≠p t·∫°i Th∆∞·ª£ng H·∫£i„ÄÇ"},

{type:"fill",
 cnWords:["‰ªñ","Âäû‰∫ã","ÈùûÂ∏∏","ËÆ§ÁúüÔºå","ÊÄÅÂ∫¶","‰∏•Ë∞®„ÄÇ"],
 pyWords:["TƒÅ","b√†nsh√¨","fƒìich√°ng","r√®nzhƒìn,","t√†id√π","y√°nj«ên."],
 missing:"Âäû‰∫ã",
 vi:"Anh ·∫•y l√†m vi·ªác r·∫•t nghi√™m t√∫c, th√°i ƒë·ªô ch·∫∑t ch·∫Ω„ÄÇ"},

{type:"fill",
 cnWords:["Âõ†‰∏∫","ÂÖ≥ÂøÉ","‰∏ãÂ±ûÔºå","Â§ßÂÆ∂","ÈÉΩ","Âæà","Â∞äÊï¨","‰ªñ„ÄÇ"],
 pyWords:["Yƒ´nw√®i","guƒÅnxƒ´n","xi√†sh«î,","d√†jiƒÅ","d≈çu","hƒõn","z≈´nj√¨ng","tƒÅ."],
 missing:"‰∏ãÂ±û",
 vi:"V√¨ quan t√¢m ƒë·∫øn c·∫•p d∆∞·ªõi n√™n m·ªçi ng∆∞·ªùi r·∫•t t√¥n tr·ªçng anh ·∫•y„ÄÇ"},

{type:"fill",
 cnWords:["‰ªñ","‰∏∫‰∫∫","Âæà","ÂÆΩÂéö„ÄÇ"],
 pyWords:["TƒÅ","w√©ir√©n","hƒõn","kuƒÅnh√≤u."],
 missing:"ÂÆΩÂéö",
 vi:"Anh ·∫•y ƒë·ªëi x·ª≠ v·ªõi ng∆∞·ªùi kh√°c r·∫•t khoan dung„ÄÇ"},

{type:"fill",
 cnWords:["Ê¨¢Ëøé","Â§ßÂÆ∂","Êù•","ÂÖ¨Âè∏","ÂèÇËßÇ„ÄÇ"],
 pyWords:["HuƒÅny√≠ng","d√†jiƒÅ","l√°i","g≈çngsƒ´","cƒÅnguƒÅn."],
 missing:"ÂèÇËßÇ",
 vi:"Hoan ngh√™nh m·ªçi ng∆∞·ªùi ƒë·∫øn tham quan c√¥ng ty„ÄÇ"},

{type:"fill",
 cnWords:["ËøôÈó¥","Â±ïËßàÂÆ§","Èáå","ÊëÜÁöÑ","ÈÉΩÊòØ","ÊúÄÊñ∞","‰∫ßÂìÅ„ÄÇ"],
 pyWords:["Zh√® jiƒÅn","zh«énl«énsh√¨","l«ê","b«éi de","d≈çu sh√¨","zu√¨xƒ´n","ch«énp«ên."],
 missing:"Â±ïËßàÂÆ§",
 vi:"Trong ph√≤ng tri·ªÉn l√£m n√†y tr∆∞ng b√†y to√†n s·∫£n ph·∫©m m·ªõi nh·∫•t„ÄÇ"},

{type:"fill",
 cnWords:["Áé∞Âú®","ÂêÑÁßçÂêÑÊ†∑","ÂïÜÂä°","Ê¥ªÂä®","ÈùûÂ∏∏","Â§ö„ÄÇ"],
 pyWords:["Xi√†nz√†i","g√®zh«íng g√®y√†ng","shƒÅngw√π","hu√≥d√≤ng","fƒìich√°ng","du≈ç."],
 missing:"ÂïÜÂä°",
 vi:"Hi·ªán nay c√≥ r·∫•t nhi·ªÅu ho·∫°t ƒë·ªông th∆∞∆°ng m·∫°i kh√°c nhau„ÄÇ"},

{type:"fill",
 cnWords:["‰ªäÂπ¥","ÈááË¥≠","‰ªªÂä°","ÂÆåÊàê","‰∫ÜÂêóÔºü"],
 pyWords:["Jƒ´nni√°n","c«éig√≤u","r√®nwu","w√°nch√©ng","le ma?"],
 missing:"ÈááË¥≠",
 vi:"Nhi·ªám v·ª• thu mua nƒÉm nay ho√†n th√†nh ch∆∞a?"},

{type:"fill",
 cnWords:["ËÅîÂêàÂõΩ","ÊÄªÈÉ®","ËÆæÂú®","Á∫ΩÁ∫¶„ÄÇ"],
 pyWords:["Li√°nh√©gu√≥","z«íngb√π","sh√® z√†i","Ni«îyuƒì."],
 missing:"ÊÄªÈÉ®",
 vi:"Tr·ª• s·ªü Li√™n H·ª£p Qu·ªëc ƒë·∫∑t t·∫°i New York„ÄÇ"},

{type:"fill",
 cnWords:["Êàë‰ª¨","Ë¶Å","Âª∫Á´ã","ÊúâÊïà","‰∫§ÊµÅ","Ê∏†ÈÅì„ÄÇ"],
 pyWords:["W«ímen","y√†o","ji√†nl√¨","y«íuxi√†o","jiƒÅoli√∫","q√∫d√†o."],
 missing:"Ê∏†ÈÅì",
 vi:"Ch√∫ng t√¥i c·∫ßn x√¢y d·ª±ng k√™nh trao ƒë·ªïi hi·ªáu qu·∫£„ÄÇ"}
];

/************* STATE *************/
let shuffled=[];
let index=0;
let history=[]; // L∆∞u l·ªãch s·ª≠ c√°c c√¢u ƒë√£ l√†m

/************* START *************/
function start(){
 document.getElementById("main").classList.remove("hidden");
 document.getElementById("nextBtn").classList.remove("hidden");
 document.getElementById("historyBtn").classList.remove("hidden");
 shuffled=[...questions].sort(()=>Math.random()-0.5);
 index=0;
 showQuestion();
}

/************* SHOW *************/
function showQuestion(){
 // Reset t·∫•t c·∫£
 document.getElementById("pinyin").innerHTML="";
 document.getElementById("meaning").innerHTML="";
 document.getElementById("sentence").innerHTML="";
 document.getElementById("answer").value="";
 document.getElementById("answer").style.borderColor="#e0e7ff";
 document.getElementById("answer").style.background="#fafbff";

 let q=shuffled[index];

 document.getElementById("qtitle").innerText=`C√¢u ${index+1}/${shuffled.length}`;

 if(q.type==="listen"){
  document.getElementById("instruction").innerText="üî¢ Nghe & nh·∫≠p l·∫°i c√¢u";
  // C√¢u listen: KH√îNG hi·ªán g√¨ c·∫£
  document.getElementById("sentence").innerHTML="";
 }else if(q.type==="fill"){
  document.getElementById("instruction").innerText="‚úè ƒêi·ªÅn t·ª´ v√†o ch·ªó tr·ªëng";
  // C√¢u fill: hi·ªán c√¢u v·ªõi ch·ªó tr·ªëng
  let sentenceHTML = "";
  for(let i=0; i<q.cnWords.length; i++){
   if(q.cnWords[i] === q.missing){
    sentenceHTML += `<span class='word' style='color:#dc2626;font-weight:700'>_____</span>`;
   }else{
    sentenceHTML += `<span class='word'>${q.cnWords[i]}</span>`;
   }
  }
  document.getElementById("sentence").innerHTML = sentenceHTML;
 }

 playAudio();
}

/************* AUDIO - Web Speech API *************/
function playAudio(){
 let text = shuffled[index].cnWords.join("");

 // Ki·ªÉm tra tr√¨nh duy·ªát c√≥ h·ªó tr·ª£ Web Speech API kh√¥ng
 if ('speechSynthesis' in window) {
  // H·ªßy t·∫•t c·∫£ c√°c √¢m thanh ƒëang ph√°t
  window.speechSynthesis.cancel();

  let utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'zh-CN'; // Ti·∫øng Trung gi·∫£n th·ªÉ
  utterance.rate = 0.85; // T·ªëc ƒë·ªô ph√°t (ch·∫≠m h∆°n m·ªôt ch√∫t)
  utterance.pitch = 1; // √Çm ƒëi·ªáu

  // Ch·ªù voices load xong (ƒë·∫∑c bi·ªát quan tr·ªçng tr√™n Chrome)
  if (window.speechSynthesis.getVoices().length === 0) {
   window.speechSynthesis.addEventListener('voiceschanged', function() {
    setChineseVoice(utterance);
    window.speechSynthesis.speak(utterance);
   }, { once: true });
  } else {
   setChineseVoice(utterance);
   window.speechSynthesis.speak(utterance);
  }
 } else {
  alert("Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ph√°t √¢m thanh. Vui l√≤ng s·ª≠ d·ª•ng Chrome ho·∫∑c Edge.");
 }
}

function setChineseVoice(utterance) {
 let voices = window.speechSynthesis.getVoices();
 // T√¨m gi·ªçng ti·∫øng Trung t·ªët nh·∫•t
 let chineseVoice = voices.find(voice =>
  voice.lang === 'zh-CN' || voice.lang === 'zh-Hans-CN' || voice.lang.startsWith('zh')
 );
 if (chineseVoice) {
  utterance.voice = chineseVoice;
 }
}

/************* CHECK *************/
function normalize(s){
 return s.replace(/[\sÔºå„ÄÇ„ÄÅÔºÅÔºü,.!ÔºüÔºõÔºö"" ''‚Äî‚Ä¶-]/g,"");
}
function autoCheck(){
 let q=shuffled[index];
 let v=normalize(document.getElementById("answer").value);
 let real=normalize(q.cnWords.join(""));
 let inp=document.getElementById("answer");
 if(v&&v===real){
  inp.style.borderColor="#16a34a";
  inp.style.background="#f0fdf4";
  createConfetti();
 }else{
  inp.style.borderColor="#e0e7ff";
  inp.style.background="#fafbff";
 }
}

/************* CONFETTI *************/
function createConfetti(){
 const colors=['#ff6b6b','#4ecdc4','#45b7d1','#f9ca24','#6c5ce7','#a29bfe','#fd79a8','#fdcb6e'];
 for(let i=0;i<50;i++){
  let confetti=document.createElement('div');
  confetti.className='confetti';
  confetti.style.left=Math.random()*100+'vw';
  confetti.style.background=colors[Math.floor(Math.random()*colors.length)];
  confetti.style.animationDuration=(Math.random()*2+2)+'s';
  confetti.style.animation='confetti-fall linear forwards';
  confetti.style.animationDelay=Math.random()*0.3+'s';
  document.body.appendChild(confetti);
  setTimeout(()=>confetti.remove(),4000);
 }
}

/************* NGHƒ®A *************/
function showVietnamese(){
 document.getElementById("meaning").innerHTML=shuffled[index].vi;
}

/************* ANSWER *************/
function showAnswer(){
 let q=shuffled[index];

 document.getElementById("pinyin").innerHTML=
   q.pyWords.map(p=>`<span class='pin'>${p}</span>`).join("");

 if(q.type==="listen"){
  document.getElementById("sentence").innerHTML=
   q.cnWords.map(w=>`<span class='word answerWord'>${w}</span>`).join("");
 }else{
  document.getElementById("sentence").innerHTML=
   q.cnWords.map(w=>
     (w===q.missing)
       ? `<span class='word answerWord'>${w}</span>`
       : `<span class='word'>${w}</span>`
   ).join("");
 }

 document.getElementById("meaning").innerHTML=q.vi;
}

/************* NEXT *************/
function next(){
 // L∆∞u c√¢u hi·ªán t·∫°i v√†o l·ªãch s·ª≠ tr∆∞·ªõc khi chuy·ªÉn
 saveToHistory();

 index++;
 if(index>=shuffled.length) index=0;
 showQuestion();
}

/************* HISTORY *************/
function saveToHistory(){
 let q=shuffled[index];
 let userInput=document.getElementById("answer").value.trim();
 let correctAnswer=q.cnWords.join("");
 let normalizedUser=normalize(userInput);
 let normalizedCorrect=normalize(correctAnswer);

 let status='skipped';
 if(userInput){
  status = (normalizedUser===normalizedCorrect) ? 'correct' : 'wrong';
 }

 history.push({
  question:q,
  userAnswer:userInput || "(B·ªè qua)",
  correctAnswer:correctAnswer,
  status:status,
  timestamp:new Date()
 });
}

function toggleHistory(){
 let main=document.getElementById("main");
 let historyView=document.getElementById("historyView");

 if(historyView.classList.contains("hidden")){
  main.classList.add("hidden");
  historyView.classList.remove("hidden");
  renderHistory();
 }else{
  main.classList.remove("hidden");
  historyView.classList.add("hidden");
 }
}

function renderHistory(){
 let container=document.getElementById("historyList");

 if(history.length===0){
  container.innerHTML="<p style='text-align:center;color:#6b7280;padding:40px'>Ch∆∞a c√≥ c√¢u n√†o ƒë∆∞·ª£c l√†m</p>";
  return;
 }

 let html="";
 for(let i=history.length-1; i>=0; i--){
  let item=history[i];
  let q=item.question;

  let statusText=item.status==='correct'?'‚úì ƒê√∫ng':(item.status==='wrong'?'‚úó Sai':'‚äò B·ªè qua');
  let statusClass=item.status;

  html+=`<div class="historyItem ${statusClass}">
   <div class="historyMeta">
    <span>${q.type==='listen'?'üî¢ Nghe':'‚úè ƒêi·ªÅn t·ª´'}</span>
    <span class="statusBadge ${statusClass}">${statusText}</span>
   </div>
   <div class="historyQuestion">
    ${q.cnWords.map((w,idx)=>`<span class='word'>${w}</span>`).join("")}
   </div>
   <div style="font-size:15px;color:#6b7280;margin:4px 0">
    ${q.pyWords.map(p=>`<span class='pin'>${p}</span>`).join("")}
   </div>
   <div style="font-size:16px;color:#059669;margin:4px 0">${q.vi}</div>
   ${item.status!=='skipped'?`
   <div class="historyAnswer">
    <div><strong>B·∫°n tr·∫£ l·ªùi:</strong> <span class="userAnswer">${item.userAnswer}</span></div>
    ${item.status==='wrong'?`<div><strong>ƒê√°p √°n ƒë√∫ng:</strong> <span class="correctAnswer">${item.correctAnswer}</span></div>`:''}
   </div>
   `:''}
  </div>`;
 }

 container.innerHTML=html;
}

function clearHistory(){
 if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô l·ªãch s·ª≠?")){
  history=[];
  renderHistory();
 }
}

</script>
</body>
</html>
